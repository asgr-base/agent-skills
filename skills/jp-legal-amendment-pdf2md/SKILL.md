---
name: jp-legal-amendment-pdf2md
description: Convert Japanese legal amendment PDF (縦書き・新旧対照表形式) to Markdown. Handles vertical text, before/after comparison tables, and marks changed sections with bold/underline formatting.
version: 1.1.0
author: claude_code
updateDate: 2026-01-25
---

# 法令改正案PDF → Markdown変換スキル

日本の法令改正案PDF（縦書き・新旧対照表形式）をMarkdownに変換するスキルです。

## 対象文書の特徴

- **縦書き**: 日本の法令文書は縦書きで記載
- **新旧対照表形式**: 改正後（左）・改正前（右）の2段組み比較
- **傍線による変更表示**: 変更箇所に傍線（下線）が付与
- **条項番号の対応**: 改正による条項番号の繰り上げ・繰り下げ

## ⚠️ 重要な制限事項

**Doclingは縦書きPDFのテキスト抽出順序を正しく処理できません。**

縦書きPDFをDoclingで変換すると、テキストが断片化・順序が乱れた状態で出力されます。そのため、このスキルでは以下のワークフローを採用します：

1. **Docling基本変換**: 画像抽出とテーブル構造の参考情報として使用
2. **PDF直接参照**: Claude Code（AI）がPDFを直接読み取り、内容を理解
3. **手動Markdown作成**: 理解した内容に基づいて適切な構造のMarkdownを作成

## 使用方法

### Step 1: Doclingで基本変換（参考情報の抽出）

```bash
# 基本変換コマンド
docling "path/to/input.pdf" \
  --to md \
  --output "output_directory" \
  --image-export-mode referenced \
  --table-mode accurate \
  -v
```

**目的**:
- 画像ファイルの抽出（図表がある場合）
- テーブル構造の参考情報
- 基本的なテキスト抽出（順序は乱れている可能性あり）

**期待される変換時間**: 20-30ページで60-90秒程度

### Step 2: Docling出力の確認と整理

#### Step 2a: 出力ファイルの確認

```bash
# 出力ファイルを確認
ls -la "output_directory/"

# Doclingが作成するファイル:
# - filename.md（テキストは乱れている可能性あり）
# - filename_artifacts/（画像ファイル）
```

#### Step 2b: 画像ファイルをassets構造に移動

```bash
# 変数設定
BASE_NAME=$(basename "input.pdf" .pdf)
MD_FILE="${BASE_NAME}_legal_docling.md"
IMAGES_DIR="assets/${BASE_NAME}_legal_docling"

# assetsディレクトリ作成と画像移動
cd "output_directory"
ARTIFACTS_DIR=$(find . -type d -name "*_artifacts" | head -1)

if [ -n "$ARTIFACTS_DIR" ] && [ -d "$ARTIFACTS_DIR" ]; then
    mkdir -p "$IMAGES_DIR"
    mv "$ARTIFACTS_DIR"/*.png "$IMAGES_DIR/" 2>/dev/null || true
    rm -rf "$ARTIFACTS_DIR"
    echo "✅ Images moved to $IMAGES_DIR"
else
    echo "⚠️ No artifacts directory found (document may not contain images)"
fi
```

#### Step 2c: Doclingの中間ファイルを削除

```bash
# Doclingが作成した乱れたMarkdownファイルを削除
rm -f "output_directory/${BASE_NAME}.md"

# 深いディレクトリ構造も削除
rm -rf "output_directory/Users/" 2>/dev/null || true
```

### Step 3: PDFを直接参照して手動整形（重要）

**このステップが最も重要です。**

Claude CodeのRead toolでPDFを直接読み取り、以下の構造でMarkdownを作成します：

#### Step 3a: 文書構造の把握

PDFを読み取り、以下を確認：
- 法令名・改正命令名
- 施行日
- 改正対象の条項（第○条、第○項、第○号）
- 改正後と改正前の対比構造

#### Step 3b: Markdownファイルの作成

以下のテンプレートに従ってMarkdownを作成：

```markdown
---
createDate: {YYYY-MM-DD}
author:
  - claude_code
tags:
  - "#claude_code"
  - "#legal_amendment"
---

# {法令改正命令の正式名称}

## 概要

- **改正対象法令**: {改正される法令名}
- **公布日**: 令和○年○月○日
- **施行日**: 令和○年○月○日

---

## 改正内容

### 第○条（条文タイトル）

#### 第○項第○号

| 改正後 | 改正前 |
|---|---|
| イ **変更箇所は太字** で表示される条文... | イ 改正前の条文... |
| ロ **[新設]** 新規追加の条文... | ［加える。］ |
| ［号の細分を削る。］ | ハ 削除される条文... |

> **注記**: 号の細分を二つずつ繰り上げる。
> - 改正前「ヘ」→ 改正後「ニ」
> - 改正前「ト」→ 改正後「ホ」

---

## 附則

この命令は、令和○年○月○日から施行する。

---

## 参考

- **原文PDF**: {PDFファイル名}
- **変換日**: {YYYY-MM-DD}
```

#### Step 3c: 変更箇所のマーキング

| マーキング種別 | Markdown表現 | 用途 |
|---|---|---|
| 変更箇所 | `**変更された文言**` | 傍線が引かれた部分 |
| 新規追加 | `**[新設]**` または `**[新規追加]**` | 新しく追加された条文 |
| 削除 | `［号の細分を削る。］` | 削除される条文 |
| 同上表記 | `［同上］` | 改正前後で変更なし |
| 繰り上げ・繰り下げ | `> **注記**: ...` | 条項番号の変更 |

### Step 4: 最終ファイルの保存

```bash
# 最終的なファイル構造
output_directory/
├── filename_legal_docling.md    # 手動整形済みMarkdown
└── assets/
    └── filename_legal_docling/  # 抽出画像（もしあれば）
        └── image_*.png
```

### Step 5: 品質チェック

以下の品質チェックリストを確認：

#### 必須チェック項目

- [ ] **縦書きテキストが正しく横書きに変換されている**
- [ ] **改正後・改正前の対比構造が維持されている**
- [ ] **変更箇所が太字でマーキングされている**
- [ ] **条項番号が正しく対応している**
- [ ] **「同上」「加える」「削る」等の注記が適切に処理されている**
- [ ] **附則（施行日等）が記載されている**
- [ ] **フロントマター（createDate, author, tags）が正しく設定されている**

#### オプション確認項目

- [ ] 画像がある場合、assets構造に正しく配置されている
- [ ] Markdown内の画像参照パスが正しい（`![Image](assets/filename_legal_docling/image_*.png)`）
- [ ] 不要な中間ファイルが削除されている

## 変換例

### 入力（PDF縦書き新旧対照表）

```
改正後                          改正前
─────────────────────────────────────────
第六条 法第四条第一項...        第六条 ［同上］
一 自然人である顧客等...        一 ［同上］
イ 当該顧客等...（傍線部分）    イ 当該顧客等...
```

### 出力（Markdown横書き比較表）

```markdown
## 第六条（顧客等の本人特定事項の確認方法）

### 第一項第一号

| 改正後 | 改正前 |
|---|---|
| 第六条 法第四条第一項に規定する... | 第六条 ［同上］ |
| 一 自然人である顧客等について... | 一 ［同上］ |
| イ 当該顧客等又はその代表者等から当該顧客等の本人確認書類のうち、同条第一号又は第四号に定めるもの...であって、**氏名、住居、生年月日及び写真の情報が記録されている半導体集積回路**が組み込まれたもの（以下「**特定半導体集積回路付き本人確認書類**」という。）の提示を受けるとともに、**当該特定半導体集積回路付き本人確認書類に組み込まれた半導体集積回路に記録された当該情報をこれを読み取るための装置を用いて読み取ることにより映像面に表示させる方法** | イ 当該顧客等又はその代表者等から当該顧客等の本人確認書類のうち同条第一号又は第四号に定めるもの...の提示を受ける方法 |
```

## 特殊表記の処理

### 1. 同上表記

```markdown
| 改正後 | 改正前 |
|---|---|
| 第六条 法第四条第一項に規定する... | 第六条 ［同上］ |
```

「［同上］」は改正前後で変更がないことを示します。

### 2. 条項番号の繰り上げ・繰り下げ

```markdown
> **注記**: 号の細分を二つずつ繰り上げる。
> - 改正前「ヘ」→ 改正後「ニ」
> - 改正前「ト」→ 改正後「ホ」
```

### 3. 新規追加・削除

```markdown
| 改正後 | 改正前 |
|---|---|
| ⑴ 当該顧客等又はその代表者等から... **[新規追加]** | ［加える。］ |
| ［号の細分を削る。］ | ハ 当該顧客等若しくは... |
```

## 出力ファイル構造

```
output_directory/
├── filename_legal_docling.md    # 整形済みMarkdown
└── assets/
    └── filename_legal_docling/  # 抽出画像（もしあれば）
        └── image_*.png
```

**命名規則:**
- Markdownファイル: `{元ファイル名}_legal_docling.md`
- 画像ディレクトリ: `assets/{元ファイル名}_legal_docling/`

## トラブルシューティング

### Doclingの出力テキストが乱れている

**原因**: 縦書きPDFはDoclingで正しく処理できません。
**対処**: Doclingの出力は参考程度とし、PDFを直接読み取って手動でMarkdownを作成してください。

### 画像が抽出されない

**原因**: PDFに埋め込み画像がない、または画像がベクターグラフィックス。
**対処**: ほとんどの法令改正案PDFは文字のみで構成されているため、画像がなくても正常です。

### 条項の対応関係が複雑

**原因**: 繰り上げ・繰り下げにより条項番号が大きく変わっている。
**対処**: 「号の細分を○つずつ繰り上げる」等の注記を確認し、対応表を作成してください。

## 関連スキル

- `pdf2md-docling`: 一般的なPDF→Markdown変換（横書き文書向け）
- `xlsx2md-docling`: Excel→Markdown変換
- `pptx2md-docling`: PowerPoint→Markdown変換

## ワークフロー図

```
┌─────────────────────────────────────────────────────────────────┐
│                    法令改正案PDF変換ワークフロー                    │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ Step 1: Docling基本変換                                          │
│ - 画像抽出                                                       │
│ - 参考テキスト抽出（順序は乱れる可能性あり）                           │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ Step 2: ファイル整理                                              │
│ - 画像をassets構造に移動                                          │
│ - 中間ファイル削除                                                │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ Step 3: PDF直接参照 + 手動Markdown作成（重要）                      │
│ - Claude CodeがPDFを直接読み取り                                  │
│ - 改正前後の対比構造を理解                                         │
│ - 変更箇所を太字でマーキング                                        │
│ - 適切な構造のMarkdownを作成                                       │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ Step 4: 最終ファイル保存                                          │
│ - {filename}_legal_docling.md                                    │
│ - assets/{filename}_legal_docling/                               │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ Step 5: 品質チェック                                              │
│ - 対比構造の確認                                                  │
│ - 変更箇所のマーキング確認                                         │
│ - 条項番号の対応確認                                               │
└─────────────────────────────────────────────────────────────────┘
```
